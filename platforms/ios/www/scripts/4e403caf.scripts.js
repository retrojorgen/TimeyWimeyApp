"use strict";angular.module("TimeyWimeyApp",["ngCookies","ngResource","ngSanitize","ngRoute","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("TimeyWimeyApp").controller("MainCtrl",["$rootScope","$scope","$timeout",function(a,b,c){b.db=new PouchDB("TimeyWimeyDB"),b.timers=[],b.totalTimer={minutes:0,seconds:0},b.editObject={},b.addTimer=function(){var c={};c.doc={name:"",seconds:0,pastSeconds:0,time:{minutes:0,seconds:0},counting:!1},b.db.post(c.doc,function(d,e){e&&a.$apply(function(){c.doc._id=e.id,c.doc._rev=e.rev,b.timers.push(c),b.setEditObject(c.doc)})})},b.setEditObject=function(a){b.editObject=a,jQuery("#editor").show(),jQuery(".input").focus()},b.closeEditor=function(){jQuery("#editor").hide(),jQuery(".input").blur(),console.log(b.editObject),b.db.put(b.editObject,function(c,d){a.$apply(function(){b.editObject._id=d.id,b.editObject._rev=d.rev})})},b.deleteTimer=function(c){b.db.remove(c.doc,function(d,e){e&&a.$apply(function(){var a=b.timers.indexOf(c);b.timers.splice(a,1),console.log(b.timers)})})},b.setTime=function(a){var b=Math.floor(a/60),c=a-60*b;return{minutes:b,seconds:c}},b.getAllSeconds=function(a){var b=0;return a.forEach(function(a){b+=a.doc.seconds}),b},b.timeCounterTimeoutInterval=function(d){d.timeoutInterval=c(function(){var c=new Date,e=Math.round((c-d.doc.currentDate)/1e3);d.doc.pastSeconds&&(e+=d.doc.pastSeconds),d.doc.seconds=e,d.doc.time=b.setTime(d.doc.seconds),b.totalTimer=b.setTime(b.getAllSeconds(b.timers)),b.db.put(d.doc,function(b,c){a.$apply(function(){d.doc._id=c.id,d.doc._rev=c.rev})}),b.timeCounterTimeoutInterval(d)},1e3)},b.toggleTimeCounter=function(a){a.doc.counting?b.stopTimeCounter(a):(a.doc.counting=!0,a.doc.currentDate=new Date,b.timeCounterTimeoutInterval(a))},b.stopTimeCounter=function(d){c.cancel(d.timeoutInterval),d.doc.pastSeconds=d.doc.seconds,d.doc.counting=!1,b.db.put(d.doc,function(b,c){a.$apply(function(){d.doc._id=c.id,d.doc._rev=c.rev})})},b.clearData=function(){b.timers=[],b.totalTimer={minutes:0,seconds:0}},b.getAllTimers=function(){b.db.allDocs({include_docs:!0,descending:!0},function(c,d){a.$apply(function(){d.rows.forEach(function(a){a.doc.counting=!1,b.timers.push(a)})})})},b.getAllTimers()}]),angular.module("TimeyWimeyApp").filter("numberFilter",function(){return function(a){return a.toString().length<2?"0"+a:a}});